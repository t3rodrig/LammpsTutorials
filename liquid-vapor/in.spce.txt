# SPC/E water box 
units   real  
atom_style  full

pair_style  lj/cut/coul/long 10.0 10.0
kspace_style  pppm 1.0e-4

bond_style  harmonic
angle_style harmonic
dihedral_style  none
improper_style  none

read_data "data.spce.old.txt"
velocity  all create 300 432567 dist uniform

pair_coeff  1 1 0.15535 3.166
pair_coeff  * 2 0.0000 0.0000 

bond_coeff  1 1000.00 1.000
angle_coeff 1 100.0 109.47

special_bonds   lj/coul 0.0 0.0 0.5

neighbor        2.0 bin
neigh_modify  every 1 delay 0 check yes

timestep  2.0

fix   1 all shake 0.0001 20 0 b 1 a 1
fix   2 all nvt temp 300.0 300.0 200.0

thermo_style    one
thermo    100

#Stadardised output for easy loading by analysis scripts
#LAMMPS can output dcd, xtc, and xyz formats easily. MDAnalysis can read all of these.
dump  1 all custom 100 traj.lammpstrj id mol type x y z ix iy iz 
dump  2 all dcd 100 traj.dcd
#dump  3 all xtc 100 traj.xtc
#dump  4 all xyz 100 traj.xyz

#for point dipoles, when they are used, dump custom will be needed to save the dipole magnitudes and directions
#This will require a custom parser to read, but is needed to get info about point dipoles
#dump 5 all custom 100 traj.txt id mol type x y z ix iy iz q mux muy muz mu

run   $(5e6)
#run 0

write_dump all atom confout.lammpstrj modify scale no sort id
write_data "data.spce.new.txt"
write_restart "rst.spce.new.bin"
